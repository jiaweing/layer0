---
title: "Architecture"
description: "Understanding Layer0's modern full-stack architecture"
---

# Architecture

Layer0 follows a modern, scalable full-stack architecture designed for developer productivity and application performance.

## System Overview

```mermaid
graph TB
    User[ğŸ‘¤ User] --> Frontend[ğŸŒ Next.js Frontend<br/>Port 3000]
    Frontend --> Backend[âš¡ Hono Backend<br/>Port 3001]
    Backend --> MongoDB[(ğŸƒ MongoDB<br/>User Data)]
    Backend --> Convex[(ğŸ“Š Convex<br/>Real-time Data)]
    Backend --> S3[â˜ï¸ AWS S3<br/>File Storage]

    Frontend -.-> Convex

    subgraph "Authentication Layer"
        Auth[ğŸ”’ Better Auth]
    end

    Backend --> Auth
    Frontend --> Auth
```

## Core Components

### Frontend (Next.js + React Router)

The frontend is built with Next.js but configured for **client-side only** rendering using React Router for navigation.

**Key Features:**

- ğŸ¨ **Tailwind CSS** for styling with shadcn/ui components
- ğŸŒ“ **Dark/Light theme** support with next-themes
- ğŸ›¡ï¸ **Protected routes** with authentication context
- ğŸ“± **Responsive design** for mobile and desktop
- âš¡ **Fast navigation** with React Router

**Technology Stack:**

- Next.js 15.3.1
- React 19
- React Router 7.6.1
- Tailwind CSS 4
- TypeScript 5

### Backend (Hono API Server)

A lightweight, fast API server built with Hono providing RESTful endpoints.

**Key Features:**

- ğŸš€ **High performance** with Hono's lightweight framework
- ğŸ”’ **Authentication** integration with Better Auth
- ğŸ—„ï¸ **Database** connections to MongoDB and Convex
- ğŸ“ **File uploads** to AWS S3
- ğŸŒ **CORS** configured for frontend communication

**Technology Stack:**

- Hono 4.7.11
- Better Auth 1.2.8
- MongoDB 6.17.0
- Node.js with TypeScript

### Database Layer

Layer0 uses a dual-database approach for different use cases:

#### MongoDB (Primary Database)

- **Purpose**: User authentication and persistent data
- **Usage**: Better Auth user sessions, profiles, settings
- **Benefits**: Mature, reliable, excellent for user data

#### Convex (Real-time Database)

- **Purpose**: Real-time features and dynamic content
- **Usage**: Posts, comments, likes, real-time updates
- **Benefits**: Built-in real-time subscriptions, TypeScript-first

### Authentication (Better Auth)

Comprehensive authentication system with modern security practices.

**Features:**

- ğŸ“§ **Email/Password** authentication
- ğŸª **Secure sessions** with HTTP-only cookies
- ğŸ”„ **Session management** with automatic refresh
- ğŸ›¡ï¸ **CSRF protection** built-in
- ğŸ”’ **Password hashing** with bcrypt

## Data Flow

### Authentication Flow

```mermaid
sequenceDiagram
    participant U as User
    participant F as Frontend
    participant B as Backend
    participant M as MongoDB

    U->>F: Sign up/Sign in
    F->>B: POST /api/auth/sign-in
    B->>M: Validate credentials
    M-->>B: User data
    B-->>F: Set session cookie
    F-->>U: Redirect to dashboard
```

### API Request Flow

```mermaid
sequenceDiagram
    participant F as Frontend
    participant B as Backend
    participant A as Better Auth
    participant D as Database

    F->>B: API Request + Cookie
    B->>A: Verify session
    A-->>B: User context
    B->>D: Query/Mutation
    D-->>B: Data
    B-->>F: JSON Response
```

### Real-time Data Flow

```mermaid
sequenceDiagram
    participant U1 as User 1
    participant U2 as User 2
    participant F1 as Frontend 1
    participant F2 as Frontend 2
    participant C as Convex

    U1->>F1: Create post
    F1->>C: Mutation
    C-->>F1: Post created
    C-->>F2: Real-time update
    F2-->>U2: New post appears
```

## File Structure

```
layer0/
â”œâ”€â”€ backend/                 # Hono API server
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts        # Main server entry
â”‚   â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.ts     # Better Auth config
â”‚   â”‚   â”‚   â”œâ”€â”€ database.ts # MongoDB connection
â”‚   â”‚   â”‚   â””â”€â”€ s3.ts       # AWS S3 client
â”‚   â”‚   â””â”€â”€ routes/         # API route handlers
â”‚   â”œâ”€â”€ convex/             # Convex schema & functions
â”‚   â”‚   â”œâ”€â”€ schema.ts       # Data models
â”‚   â”‚   â”œâ”€â”€ posts.ts        # Post operations
â”‚   â”‚   â”œâ”€â”€ likes.ts        # Like operations
â”‚   â”‚   â””â”€â”€ comments.ts     # Comment operations
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ frontend/               # Next.js frontend
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app/           # Next.js app directory
â”‚   â”‚   â”œâ”€â”€ components/    # React components
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/      # Auth-related components
â”‚   â”‚   â”‚   â”œâ”€â”€ providers/ # React context providers
â”‚   â”‚   â”‚   â””â”€â”€ ui/        # Reusable UI components
â”‚   â”‚   â”œâ”€â”€ lib/           # Utility libraries
â”‚   â”‚   â”œâ”€â”€ hooks/         # Custom React hooks
â”‚   â”‚   â””â”€â”€ routes/        # Route components
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ docs/                   # Documentation (Fumadocs)
â””â”€â”€ package.json           # Root workspace config
```

## Security Architecture

### Authentication Security

- **Secure Cookies**: HTTP-only, SameSite, Secure flags
- **Session Management**: Automatic rotation and expiry
- **Password Security**: bcrypt hashing with salt
- **CSRF Protection**: Built into Better Auth

### API Security

- **CORS Configuration**: Restricted to trusted origins
- **Input Validation**: Request validation on all endpoints
- **Environment Variables**: Sensitive data in env files
- **TypeScript**: Compile-time type safety

## Scalability Considerations

### Horizontal Scaling

- **Stateless Backend**: Easy to scale with load balancers
- **Database Scaling**: MongoDB replica sets, Convex auto-scales
- **CDN Integration**: S3 + CloudFront for static assets

### Performance Optimizations

- **Client-Side Routing**: Fast navigation with React Router
- **Code Splitting**: Next.js automatic code splitting
- **Image Optimization**: Built-in Next.js image optimization
- **Caching**: Browser caching, API response caching

## Development vs Production

### Development

- **Hot Reload**: Automatic code reloading
- **Source Maps**: Debugging support
- **Local Databases**: MongoDB local instance
- **Development Logging**: Detailed error messages

### Production

- **Optimized Builds**: Minified, tree-shaken code
- **Environment Variables**: Production secrets
- **Database Clusters**: MongoDB Atlas, Convex Cloud
- **Error Monitoring**: Production error tracking

## Next Steps

<Cards>
  <Card title="Backend Development" href="/docs/backend" icon="âš¡">
    Learn about the Hono backend implementation
  </Card>
  <Card title="Frontend Development" href="/docs/frontend" icon="ğŸŒ">
    Explore the Next.js + React Router frontend
  </Card>
  <Card title="Database Guide" href="/docs/database" icon="ğŸ“Š">
    Understanding MongoDB and Convex integration
  </Card>
  <Card title="Authentication Deep Dive" href="/docs/authentication" icon="ğŸ”’">
    Master Better Auth implementation
  </Card>
</Cards>
