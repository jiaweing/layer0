---
title: "Development Workflow"
description: "A comprehensive guide to developing with Layer0, including setup, workflows, and best practices."
---

import { Card, Cards } from "fumadocs-ui/components/card";
import { Step, Steps } from "fumadocs-ui/components/steps";

# Development Workflow

This guide covers the complete development workflow for Layer0, from initial setup to production deployment.

## Development Environment Setup

<Steps>

<Step>

### Prerequisites

Ensure you have the following installed:

- **Node.js** (v18 or higher)
- **pnpm** (recommended package manager)
- **MongoDB** (local or cloud instance)
- **Git** for version control

```bash
# Install pnpm globally
npm install -g pnpm

# Verify installations
node --version
pnpm --version
git --version
```

</Step>

<Step>

### Project Setup

Clone and set up the Layer0 project:

```bash
# Clone the repository
git clone <repository-url>
cd layer0

# Install dependencies for all workspaces
pnpm install

# Set up environment variables
cp .env.example .env
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env
```

</Step>

<Step>

### Environment Configuration

Configure your environment variables:

**Root `.env`:**

```bash
# Database
MONGODB_URI=mongodb://localhost:27017/layer0
CONVEX_DEPLOYMENT=dev:your-deployment

# Authentication
BETTER_AUTH_SECRET=your-secret-key
BETTER_AUTH_URL=http://localhost:3001

# Storage (optional)
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=your-access-key
AWS_SECRET_ACCESS_KEY=your-secret-key
S3_BUCKET_NAME=your-bucket
```

</Step>

</Steps>

## Development Scripts

### Available Commands

Layer0 provides several scripts for different development tasks:

```bash
# Start all services in development mode
pnpm dev

# Start individual services
pnpm dev:backend    # Hono server on port 3001
pnpm dev:frontend   # Next.js app on port 3000
pnpm dev:docs      # Documentation site

# Build and type checking
pnpm build         # Build all projects
pnpm type-check    # Run TypeScript checks
pnpm lint         # Run ESLint

# Database operations
pnpm db:push      # Push schema changes
pnpm db:seed      # Seed database with sample data
```

### Workspace Structure

Layer0 uses pnpm workspaces for efficient package management:

```json
{
  "workspaces": ["backend", "frontend", "docs"]
}
```

Each workspace has its own `package.json` and can be developed independently.

## Development Workflow

### 1. Feature Development

<Steps>

<Step>

### Create Feature Branch

```bash
# Create and switch to feature branch
git checkout -b feature/your-feature-name

# Keep main branch updated
git pull origin main
```

</Step>

<Step>

### Backend Development

For backend changes:

```bash
# Navigate to backend directory
cd backend

# Start development server
pnpm dev

# The server will restart automatically on file changes
```

**Backend file structure:**

```
backend/src/
├── index.ts           # Server entry point
├── lib/
│   ├── auth.ts       # Authentication logic
│   ├── database.ts   # Database connection
│   └── convex.ts     # Convex integration
└── routes/
    ├── users.ts      # User management
    ├── posts.ts      # Post operations
    ├── comments.ts   # Comment system
    └── likes.ts      # Like functionality
```

</Step>

<Step>

### Frontend Development

For frontend changes:

```bash
# Navigate to frontend directory
cd frontend

# Start development server
pnpm dev

# Access the app at http://localhost:3000
```

**Key development features:**

- Hot module replacement
- Fast refresh for React components
- TypeScript support with strict mode
- Tailwind CSS for styling

</Step>

<Step>

### Real-time Features

For Convex-related changes:

```bash
# Navigate to backend/convex
cd backend/convex

# Deploy functions to development environment
npx convex dev

# Monitor real-time updates
npx convex dashboard
```

</Step>

</Steps>

### 2. Testing Your Changes

<Steps>

<Step>

### Type Checking

Always run type checks before committing:

```bash
# Check all workspaces
pnpm type-check

# Check specific workspace
cd frontend && npx tsc --noEmit
cd backend && npx tsc --noEmit
```

</Step>

<Step>

### Linting

Ensure code quality with ESLint:

```bash
# Lint all workspaces
pnpm lint

# Auto-fix issues where possible
pnpm lint --fix
```

</Step>

<Step>

### Manual Testing

Test your changes across different scenarios:

1. **Authentication Flow**

   - Sign up new user
   - Sign in existing user
   - Password reset
   - Session persistence

2. **Core Features**

   - Create/edit/delete posts
   - Add/remove comments
   - Like/unlike posts
   - Real-time updates

3. **Error Handling**
   - Network failures
   - Invalid inputs
   - Unauthorized access

</Step>

</Steps>

### 3. Database Migrations

When making schema changes:

<Steps>

<Step>

### Update Schema

Modify the schema in `backend/convex/schema.ts`:

```typescript
// Add new fields or tables
export const posts = defineTable({
  content: v.string(),
  authorId: v.id("users"),
  createdAt: v.number(),
  // New field
  tags: v.array(v.string()),
}).index("by_author", ["authorId"]);
```

</Step>

<Step>

### Deploy Changes

```bash
# Deploy schema changes
cd backend
npx convex deploy

# For development
npx convex dev
```

</Step>

<Step>

### Update API Code

Update corresponding API routes and types:

```typescript
// Update types
interface Post {
  content: string;
  authorId: string;
  createdAt: number;
  tags: string[]; // New field
}

// Update API calls
const createPost = async (data: CreatePostData) => {
  return await api.posts.create({
    content: data.content,
    tags: data.tags || [],
  });
};
```

</Step>

</Steps>

## Code Organization

### File Naming Conventions

- **Components**: PascalCase (`UserProfile.tsx`)
- **Hooks**: camelCase with "use" prefix (`useAuth.ts`)
- **Utilities**: camelCase (`formatDate.ts`)
- **Routes**: kebab-case (`user-profile.tsx`)
- **API endpoints**: kebab-case (`/api/user-posts`)

### Import Organization

Organize imports in the following order:

```typescript
// 1. React/Next.js imports
import React from "react";
import { NextRequest } from "next/server";

// 2. Third-party libraries
import { z } from "zod";
import { Hono } from "hono";

// 3. Internal components/utilities
import { Button } from "@/components/ui/button";
import { formatDate } from "@/lib/utils";

// 4. Types
import type { User, Post } from "@/types";
```

### Component Structure

Follow this structure for React components:

```typescript
// 1. Imports
import React from "react";
import { Button } from "@/components/ui/button";

// 2. Types
interface Props {
  title: string;
  onSubmit: () => void;
}

// 3. Component
export function MyComponent({ title, onSubmit }: Props) {
  // Hooks
  const [loading, setLoading] = useState(false);

  // Event handlers
  const handleSubmit = () => {
    setLoading(true);
    onSubmit();
  };

  // Render
  return (
    <div>
      <h1>{title}</h1>
      <Button onClick={handleSubmit} disabled={loading}>
        Submit
      </Button>
    </div>
  );
}
```

## Performance Best Practices

### Frontend Optimization

- **Code Splitting**: Use dynamic imports for large components
- **Image Optimization**: Use Next.js `Image` component
- **Bundle Analysis**: Run `pnpm analyze` to check bundle size
- **Memoization**: Use `useMemo` and `useCallback` for expensive operations

### Backend Optimization

- **Database Queries**: Use indexes effectively
- **Caching**: Implement Redis for frequently accessed data
- **Rate Limiting**: Protect API endpoints from abuse
- **Error Handling**: Implement proper error boundaries

### Real-time Features

- **Connection Management**: Handle WebSocket connections efficiently
- **Data Synchronization**: Use Convex optimistic updates
- **Memory Usage**: Clean up subscriptions and listeners

## Debugging Tips

### Common Issues

<Cards>

<Card title="TypeScript Errors" icon="🔧">
  - Run `pnpm type-check` to see all errors - Check import paths are correct -
  Ensure all types are properly exported
</Card>

<Card title="Build Failures" icon="🚨">
  - Clear node_modules and reinstall - Check for version conflicts - Verify
  environment variables
</Card>

<Card title="Real-time Issues" icon="⚡">
  - Check Convex deployment status - Verify WebSocket connections - Monitor
  browser console for errors
</Card>

<Card title="Authentication Problems" icon="🔐">
  - Check Better Auth configuration - Verify JWT tokens are valid - Ensure
  session storage is working
</Card>

</Cards>

### Development Tools

- **React DevTools**: Debug component state and props
- **Network Tab**: Monitor API requests and responses
- **Convex Dashboard**: View real-time data and functions
- **MongoDB Compass**: Inspect database collections

## Next Steps

- [Deployment Guide](/docs/deployment) - Learn how to deploy Layer0
- [Testing Guide](/docs/testing) - Set up comprehensive testing
- [Security Guide](/docs/security) - Implement security best practices
- [Troubleshooting](/docs/troubleshooting) - Common issues and solutions
